#!/bin/bash
# Run the Saiman CLI test tool
# Build first if needed, then run with any passed arguments

cd "$(dirname "$0")"

# Build
xcodebuild -project Saiman.xcodeproj -scheme SaimanTests -configuration Debug build -quiet 2>/dev/null

# Find and run the built binary
BINARY=$(find ~/Library/Developer/Xcode/DerivedData/Saiman-*/Build/Products/Debug/SaimanTests -type f 2>/dev/null | head -1)

if [ -z "$BINARY" ]; then
    echo "Error: Could not find SaimanTests binary. Try building in Xcode first."
    exit 1
fi

exec "$BINARY" "$@"
